<mat-card appearance="outlined">
	<mat-card-header>
		<mat-card-title>Administraci√≥n</mat-card-title>
		<mat-card-subtitle>Configurar usuarios, roles, namespaces y procesos</mat-card-subtitle>
	</mat-card-header>

	<mat-card-content>
		<mat-tab-group mat-stretch-tabs>
			<mat-tab label="Usuarios">
				<div>
					<mat-table [dataSource]="users" class="mat-elevation-z1">
						<ng-container matColumnDef="username">
							<mat-header-cell *matHeaderCellDef> Usuario </mat-header-cell>
							<mat-cell *matCellDef="let it"> {{ it.username }} </mat-cell>
						</ng-container>

						<ng-container matColumnDef="roles">
							<mat-header-cell *matHeaderCellDef> Roles </mat-header-cell>
							<mat-cell *matCellDef="let it">
								<mat-chip-set aria-label="Roles del usuario">
									<mat-chip *ngFor="let r of it.roles"
										(removed)="confirmRemoveRoleFromUser(it, r.id)">{{
										r.name }}
										<mat-icon matChipRemove>remove</mat-icon>
									</mat-chip>
									<ng-container *ngIf="!isEditing(it); else editRolesTpl">
										<mat-chip color="primary" (click)="startEdit(it)" class="add-role-chip"
											selectable="false">
											+</mat-chip>
									</ng-container>
									<ng-template #editRolesTpl>
										<mat-chip color="primary" class="add-role-chip editing" selectable="false">
											<input #roleInput class="chip-input" type="text" [ngModel]="roleSearchText"
												(ngModelChange)="roleSearchText = $event" [matAutocomplete]="roleAuto"
												placeholder="Agregar rol" />
											<mat-icon matChipRemove aria-label="Hecho" title="Hecho" type="button"
												(click)="finishEdit()">close</mat-icon>
										</mat-chip>
									</ng-template>
									<mat-autocomplete #roleAuto="matAutocomplete"
										(optionSelected)="onRoleSelected(it, $event.option.value)">
										<mat-option *ngFor="let r of filteredRoles(it, roleSearchText)" [value]="r.id">
											{{ r.name }}
										</mat-option>
										<mat-option *ngIf="filteredRoles(it, roleSearchText).length === 0" disabled>
											sin roles
										</mat-option>
									</mat-autocomplete>
								</mat-chip-set>
							</mat-cell>
						</ng-container>

						<ng-container matColumnDef="actions">
							<mat-header-cell *matHeaderCellDef> Acciones </mat-header-cell>
							<mat-cell *matCellDef="let it">
							</mat-cell>
						</ng-container>

						<mat-header-row *matHeaderRowDef="displayedColumnsUsers"></mat-header-row>
						<mat-row *matRowDef="let row; columns: displayedColumnsUsers;"></mat-row>
					</mat-table>
				</div>
			</mat-tab>
			<mat-tab label="Roles">
				<div>
					<mat-table [dataSource]="roles" class="mat-elevation-z1">
						<ng-container matColumnDef="name">
							<mat-header-cell *matHeaderCellDef> Rol </mat-header-cell>
							<mat-cell *matCellDef="let it"> {{ it.name }} </mat-cell>
						</ng-container>
						<ng-container matColumnDef="permissions">
							<mat-header-cell *matHeaderCellDef> Permisos </mat-header-cell>
							<mat-cell *matCellDef="let it"> {{ it.permissions }} </mat-cell>
						</ng-container>
						<ng-container matColumnDef="actions">
							<mat-header-cell *matHeaderCellDef> Acciones </mat-header-cell>
							<mat-cell *matCellDef="let it">
								<button mat-icon-button aria-label="Ver" title="Ver" type="button">
									<mat-icon>visibility</mat-icon>
								</button>
								<button mat-icon-button aria-label="Editar" title="Editar" type="button">
									<mat-icon>edit</mat-icon>
								</button>
								<button mat-icon-button aria-label="Eliminar" title="Eliminar" type="button">
									<mat-icon>delete</mat-icon>
								</button>
							</mat-cell>
						</ng-container>
						<mat-header-row *matHeaderRowDef="displayedColumnsRoles"></mat-header-row>
						<mat-row *matRowDef="let row; columns: displayedColumnsRoles;"></mat-row>
					</mat-table>
				</div>
			</mat-tab>
			<mat-tab label="Namespaces">
				<div>
					<mat-table [dataSource]="namespaces" class="mat-elevation-z1">
						<ng-container matColumnDef="name">
							<mat-header-cell *matHeaderCellDef> Namespace </mat-header-cell>
							<mat-cell *matCellDef="let it"> {{ it.name }} </mat-cell>
						</ng-container>
						<ng-container matColumnDef="processes">
							<mat-header-cell *matHeaderCellDef> Procesos </mat-header-cell>
							<mat-cell *matCellDef="let it"> {{ it.processes }} </mat-cell>
						</ng-container>
						<ng-container matColumnDef="actions">
							<mat-header-cell *matHeaderCellDef> Acciones </mat-header-cell>
							<mat-cell *matCellDef="let it">
								<button mat-icon-button aria-label="Ver" title="Ver" type="button">
									<mat-icon>visibility</mat-icon>
								</button>
								<button mat-icon-button aria-label="Editar" title="Editar" type="button">
									<mat-icon>edit</mat-icon>
								</button>
								<button mat-icon-button aria-label="Eliminar" title="Eliminar" type="button">
									<mat-icon>delete</mat-icon>
								</button>
							</mat-cell>
						</ng-container>
						<mat-header-row *matHeaderRowDef="displayedColumnsNamespaces"></mat-header-row>
						<mat-row *matRowDef="let row; columns: displayedColumnsNamespaces;"></mat-row>
					</mat-table>
				</div>
			</mat-tab>
			<mat-tab label="Procesos">
				<div>
					<mat-table [dataSource]="processes" class="mat-elevation-z1">
						<ng-container matColumnDef="name">
							<mat-header-cell *matHeaderCellDef> Proceso </mat-header-cell>
							<mat-cell *matCellDef="let it"> {{ it.name }} </mat-cell>
						</ng-container>
						<ng-container matColumnDef="namespace">
							<mat-header-cell *matHeaderCellDef> Namespace </mat-header-cell>
							<mat-cell *matCellDef="let it"> {{ it.namespace }} </mat-cell>
						</ng-container>
						<ng-container matColumnDef="actions">
							<mat-header-cell *matHeaderCellDef> Acciones </mat-header-cell>
							<mat-cell *matCellDef="let it">
								<button mat-icon-button aria-label="Ver" title="Ver" type="button">
									<mat-icon>visibility</mat-icon>
								</button>
								<button mat-icon-button aria-label="Editar" title="Editar" type="button">
									<mat-icon>edit</mat-icon>
								</button>
								<button mat-icon-button aria-label="Eliminar" title="Eliminar" type="button">
									<mat-icon>delete</mat-icon>
								</button>
							</mat-cell>
						</ng-container>
						<mat-header-row *matHeaderRowDef="displayedColumnsProcesses"></mat-header-row>
						<mat-row *matRowDef="let row; columns: displayedColumnsProcesses;"></mat-row>
					</mat-table>
				</div>
			</mat-tab>
		</mat-tab-group>
	</mat-card-content>
</mat-card>